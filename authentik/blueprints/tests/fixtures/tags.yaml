version: 1
context:
    foo: bar
    policy_property: name
    policy_property_value: foo-bar-baz-qux
entries:
- attrs:
    expression: return True
  identifiers:
    name: !Format [foo-%s-%s-%s, !Context foo, !Context bar, qux]
  id: policy
  model: authentik_policies_expression.expressionpolicy
- attrs:
    attributes:
      policy_pk1: !Format ["%s-%s", !Find [authentik_policies_expression.expressionpolicy, [!Context policy_property, !Context policy_property_value], [expression, return True]], suffix]
      policy_pk2: !Format ["%s-%s", !KeyOf policy, suffix]
      boolAnd: !AsBool [AND, !Context foo, !Format ["%s", "a_string"], 1]
      boolNand: !AsBool [NAND, !Context foo, !Format ["%s", "a_string"], 1]
      boolOr: !AsBool [OR, !Context foo, !Format ["%s", "a_string"], null]
      boolNor: !AsBool [NOR, !Context foo, !Format ["%s", "a_string"], null]
      boolXor: !AsBool [XOR, !Context foo, !Format ["%s", "a_string"], 1]
      boolXnor: !AsBool [XNOR, !Context foo, !Format ["%s", "a_string"], 1]
      boolComplex: !AsBool [XNOR, !AsBool [AND, !Context non_existing], !AsBool [NOR, a string], !AsBool [XOR, null]]
  identifiers:
    name: test
  model: authentik_core.group
