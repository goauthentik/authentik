# Generated by Django 3.2 on 2021-05-03 17:06

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ("authentik_core", "0019_source_managed"),
    ]

    operations = [
        migrations.AddField(
            model_name="source",
            name="user_matching_mode",
            field=models.TextField(
                choices=[
                    ("identifier", "Use the source-specific identifier"),
                    (
                        "email_link",
                        "Link to a user with identical email address. Can have security implications when a source doesn't validate email addresses.",
                    ),
                    (
                        "email_deny",
                        "Use the user's email address, but deny enrollment when the email address already exists.",
                    ),
                    (
                        "username_link",
                        "Link to a user with identical username. Can have security implications when a username is used with another source.",
                    ),
                    (
                        "username_deny",
                        "Use the user's username, but deny enrollment when the username already exists.",
                    ),
                ],
                default="identifier",
                help_text="How the source determines if an existing user should be authenticated or a new user enrolled.",
            ),
        ),
    ]
