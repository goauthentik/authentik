name: "Process test results"
description: Convert test results to JUnit, add them to GitHub Actions and codecov

inputs:
  flags:
    description: Codecov flags

runs:
  using: "composite"
  steps:
    - uses: codecov/codecov-action@v5
      with:
        flags: ${{ inputs.flags }}
        use_oidc: true
    - uses: codecov/test-results-action@v1
      with:
        flags: ${{ inputs.flags }}
        file: unittest.xml
        use_oidc: true
    - name: PostgreSQL Logs
      shell: bash
      run: |
        docker stop setup-postgresql-1
        echo "::group::PostgreSQL Logs"
        docker logs setup-postgresql-1
        echo "::endgroup::"
