version: 1
metadata:
  labels:
    blueprints.goauthentik.io/system: "true"
  name: System - Microsoft Entra Provider - Mappings
entries:
  - identifiers:
      managed: goauthentik.io/providers/microsoft_entra/user
    model: authentik_providers_microsoft_entra.microsoftentraprovidermapping
    attrs:
      name: "authentik default Microsoft Entra Mapping: User"
      # https://learn.microsoft.com/en-us/graph/api/resources/user?view=graph-rest-1.0
      expression: |
        return {
            "displayName": request.user.name,
            "accountEnabled": request.user.is_active,
        }
  - identifiers:
      managed: goauthentik.io/providers/microsoft_entra/group
    model: authentik_providers_microsoft_entra.microsoftentraprovidermapping
    attrs:
      name: "authentik default Microsoft Entra Mapping: Group"
      # https://learn.microsoft.com/en-us/graph/api/group-post-groups?view=graph-rest-1.0&tabs=http#request-body
      expression: |
        return {
            "displayName": group.name,
            "mailEnabled": False,
            "securityEnabled": True,
        }
