# CVE-2025-64521

## Deactivated service account can authenticate to OAuth

### Summary

When authenticating with `client_id` and `client_secret` to an OAuth provider, authentik creates a service account for the provider. In previous authentik versions, authentication for this account was possible even when the account was deactivated. Other permissions are correctly applied and federation with other providers still take assigned policies correctly into account.

### Patches

authentik 2025.8.5 and 2025.10.2 fix this issue, for other versions the workaround below can be used.

### Workarounds

You can add a policy to your application that explicitly checks if the service account is still valid, and deny access if not.

```python
return request.user.is_active
```

### For more information

If you have any questions or comments about this advisory:

- Email us at [security@goauthentik.io](mailto:security@goauthentik.io).
